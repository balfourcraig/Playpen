<!DOCTYPE html>
<html lang="en-nz">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta charset="UTF-8">
	<title>SIT Bars - Craig's Playpen</title>
	<link rel="stylesheet" href="../css/styles.css">
	<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico" />
	<script src="../scripts/utils.js"></script>
	<script>
		const colors = [
			'#015581',
			'#ed6d20',
			'#3ca4dc',
			'#ee2b74',
			'#007dc3',
			'#ffc80f',
			'#b4c869',
			'#666866',
			'#22bbe3',
			'#cd2137',
			'#669b41',
			'#5e58a2',
			'#b63e97',
			'#8dc63f',
			'#00697c',
			'#363636',
			'#eb5a91',
			'#e83c2a',
			'#643514',
		];
	
		let animationID = null;
		function drawPattern(){
			document.getElementById('drawBtn').setAttribute('style','display:none');
			document.getElementById('stopDrawingBtn').removeAttribute('style');
			
			const heightMult = parseFloat(document.getElementById('heightMultInput').value);
			
			window.cancelAnimationFrame(animationID);
			const c = document.createElement('canvas');
			const w = document.getElementById('sizeCalc').getBoundingClientRect().width;
			
			const h = w * heightMult;

			c.setAttribute('width', w);
			c.setAttribute('height', h);
			const ctx = c.getContext('2d');
			const center = {x: w/2.0, y: w/2.0};
			const radius = w * 0.45;
			
			const canvResult = document.getElementById('canvResult');
			canvResult.innerHTML = '';
			canvResult.appendChild(c);
			
			ctx.lineWidth = 1;

			const numBars = parseInt(document.getElementById('barNumInput').value);
			const gutterWidth = (parseFloat(document.getElementById('barGutterInput').value) / 100) * w;
			
			const barWidth = w / numBars - gutterWidth;
			if(barWidth <= 0){
				alert('Negative bar width. Try smaller gutters');
			}
			else{
				const drawings = [];

				shuffleInplace(colors);				
				
				for(let i = 0; i < numBars; i ++){
					const left = i * barWidth + i * gutterWidth;
					ctx.fillStyle = colors[i % colors.length];
					ctx.beginPath();
					ctx.rect(left, 0, barWidth, h);
					ctx.fill();
				}
			}

			document.getElementById('drawBtn').removeAttribute('style');
			document.getElementById('stopDrawingBtn').setAttribute('style','display:none');
		}

		window.addEventListener('DOMContentLoaded', () => {
			document.getElementById('drawBtn').addEventListener('click', drawPattern);
			document.getElementById('stopDrawingBtn').addEventListener('click', () => {
				cancelAnimationFrame(animationID);
				document.getElementById('stopDrawingBtn').setAttribute('style','display:none');
				document.getElementById('drawBtn').removeAttribute('style');
			});
		});
	</script>
	
</head>
<body>
<div class="navHolder">
	<nav>
		<a href="../index.html">Home</a>
		<a class="selected" href="../ramblings.html">Deranged Ramblings</a>
		<a href="../about.html">About</a>
	</nav>
</div>

<main>
	<div class="pageWidth">
		<header>
			<h1>SIT Bars</h1>
		</header>
		<section>
			<input id="barNumInput" type="number" min="0" value="15">
			<label for="barNumInput">Number of bars</label>
			<br>
			<input id="barGutterInput" type="number" min="0" value="0.5" step="0.05" max="10">
			<label for="barGutterInput">Gutter size (percent)</label>
			<br>
			<input id="heightMultInput" type="number" min="0.1" value="0.6" step="0.1" max="5">
			<label for="heightMultInput">Height multiplier (1 is square)</label>
			<br>
			<button id="drawBtn">Draw!</button>
			<button id="stopDrawingBtn" style="display:none">STOP</button>

			<div id="sizeCalc"></div>
			<img id="modMulResult">
			<div id="canvResult"></div>
		</section>
		<div class="scrollOverflow"></div>
	</div>
</main>
</body>
</html>